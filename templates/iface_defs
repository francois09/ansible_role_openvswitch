{% if ovs__gre.peers[0].host == inventory_hostname %}
{%   set useconf = ovs__gre.peers[0] %}
{%   set remoteip = ovs__gre.peers[1].ip %}
{% else %}
{%   set useconf = ovs__gre.peers[1] %}
{%   set remoteip = ovs__gre.peers[0].ip %}
{% endif %}
auto {{ ovs__gateway }}
iface {{ ovs__gateway }} inet static
  address {{ useconf.gw }}
  netmask {{ ovs__gre.netmask }}
  post-up ovs-vsctl --may-exist add-port {{ ovs__bridge }} {{ ovs__gre.iface }} -- set interface {{ ovs__gre.iface }} type=gre options:remote_ip={{ remoteip }}
  post-up ovs-vsctl --may-exist add-port {{ ovs__bridge }} {{ ovs__gateway }} -- set interface {{ ovs__gateway }} type=internal
